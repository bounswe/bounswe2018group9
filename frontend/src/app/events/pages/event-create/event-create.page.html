<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/feed"></ion-back-button>
    </ion-buttons>
    <ion-title style="font-family: 'Garamond'; font-weight: bold;">
      Event
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-grid>
    <ion-row>
      <ion-col col-xs-12>
        <div class="event-form-container">
          <form [formGroup]="form" (ngSubmit)="createEvent()">

            <ion-list>

              <ion-item>
                <div class="event-image">
                  <img #eventImage
                       (error)="onImageError()"
                       (load)="onImageLoad()"
                       [src]="this.form.get('imageUrl').value"
                       alt="Event image">
                </div>
              </ion-item>

              <ion-item>
                <ion-label position="floating">
                  Url of the image
                  <span class="input-required">
                  *
                </span>
                  <span class="input-error" *ngIf="this.form.get('imageUrl').dirty && !this.form.get('imageUrl').valid">
                  (you should add an image link)
                </span>
                </ion-label>
                <ion-input type="url"
                           formControlName="imageUrl"
                           class="form-input">
                </ion-input>
              </ion-item>

              <ion-item>
                <ion-label position="floating">
                  Name of the event
                  <span class="input-required">
                  *
                </span>
                  <span class="input-error" *ngIf="this.form.get('name').dirty && !this.form.get('name').valid">
                  (your event should have a name)
                </span>
                </ion-label>
                <ion-input type="text"
                           max="150"
                           formControlName="name"
                           class="form-input">
                </ion-input>
              </ion-item>

              <ion-item>
                <ion-label position="floating">
                  Describe your event
                  <span class="input-required">
                  *
                </span>
                  <span class="input-error" *ngIf="this.form.get('description').dirty && !this.form.get('description').valid">
                  (you should describe your event, min: 20 character)
                </span>
                </ion-label>
                <ion-textarea type="text"
                              formControlName="description"
                              class="form-input">
                </ion-textarea>
              </ion-item>

              <ion-item>
                <ion-label position="floating">
                  When it will start
                  <span class="input-required">
                  *
                </span>
                  <span class="input-error" *ngIf="this.form.get('date').dirty && !this.form.get('date').valid">
                  (you should specify start date and time)
                </span>
                </ion-label>
                <ion-datetime
                  display-format="DD MMMM DDDD HH:mm, YYYY"
                  picker-format="DD MMM HH mm YYYY"
                  formControlName="date"
                  class="form-input">
                </ion-datetime>
              </ion-item>

              <ion-item formGroupName="locationConstruct">
                <ion-label position="floating">
                  Where it will happen
                  <span class="input-required">
                  *
                </span>
                  <span class="input-error" *ngIf="this.form.get('locationConstruct').get('locationName').dirty && !this.form.get('locationConstruct').get('locationName').valid">
                  (you should specify location name)
                </span>
                </ion-label>
                <ion-input
                  type="text"
                  formControlName="locationName"
                  class="form-input">
                </ion-input>
              </ion-item>

              <ion-item>
                <ion-label>
                  Your event is free
                  <ion-checkbox formControlName="isFree">
                  </ion-checkbox>
                </ion-label>
              </ion-item>

              <ion-item *ngIf="!this.form.get('isFree').value">
                <ion-label position="floating">
                  What is its price
                  <span class="input-required">
                  *
                </span>
                  <span class="input-error" *ngIf="this.form.get('price').dirty && !this.form.get('price').valid">
                  (you should specify price)
                </span>
                </ion-label>
                <ion-input
                  align="right"
                  type="number"
                  formControlName="price"
                  class="form-input">{{currency.value}}
                </ion-input>

                <ion-select mode="md" #currency placeholder="Select currency">
                  <ion-select-option value ='₺' >Turkish Lira</ion-select-option>
                  <ion-select-option value ='$' >Dollars</ion-select-option>
                  <ion-select-option value ='€' >Euro</ion-select-option>
                </ion-select>
              </ion-item>
              <ion-item formArrayName="artists">
                <ion-label position="floating">
                  Add an artist/artists
                </ion-label>
                <button ion-button (click)="addArtist()">
                  +
                </button>
                <div *ngFor="let artist of artists.controls; let i=index">
                  <ion-input
                    type="text"
                    [formControlName]="i"
                    [placeholder]="'Artist' + (i+1)"
                    class="form-input">
                  </ion-input>
                  <ion-button (click)="removeArtist(i)">
                    -
                  </ion-button>
                </div>
              </ion-item>
              <ion-item>
                <button ion-button type="submit" [disabled]="!form.valid">
                  <ion-icon name="share" small></ion-icon>
                  Share your experience
                </button>
              </ion-item>
            </ion-list>

          </form>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
